import{u as C,b as s,j as e,l as E}from"./index-DDca1aiV.js";import{L as F,d as L,c as _,t as P}from"./textarea-input-D1X_UlTc.js";import{S as R}from"./spinner-D5QHHuo0.js";function z({label:l,onChange:p,error:n,preview:r,help:i,url:u,filemimes:h="",dir:j="",compress:g=!1}){const{props:{auth:o}}=C(),d=s.useRef(),[N,b]=s.useState("فایلی انتخاب نشده."),[c,v]=s.useState(u),[m,x]=s.useState(!1),[k,w]=s.useState(0),y=()=>{m||d.current.click()},S=f=>{if(E.isEmpty(f.target.files)){console.log("target file empty");return}x(!0);const a=new FormData;a.append("filemimes",h),a.append("file",f.target.files[0]),a.append("dir",j),a.append("compress",g),axios.post(route("api.file.store"),a,{headers:{"Content-Type":"multipart/form-data",Authorization:o.jwt_prefix+o.jwt_token},onUploadProgress:function(t){w(Math.round(t.loaded*100/t.total))}}).then(t=>{p(t.data.name),v(t.data.url),b(t.data.name_original)}).catch(t=>{P.error(t.response.data.message)}).finally(()=>{x(!1)})};return e.jsxs("div",{className:"fieldset",children:[e.jsx(F,{label:l}),r&&r,e.jsx("div",{onClick:y,className:`h-[2.5rem] w-full p-0 input rounded-md ${n?"input-error":""}`,children:e.jsxs("div",{className:"flex flex-row space-x-2 h-full rounded-md",children:[e.jsx("div",{className:"bg-base-300 px-4 font-bold flex flex-row items-center rounded-md",children:e.jsx("div",{children:"انتخاب فایل"})}),e.jsx("div",{className:"text-opacity-35 text-base-content flex flex-row items-center",children:m?e.jsxs("div",{className:"flex flex-row space-x-2 items-center h-full pl-2",children:[e.jsx(R,{}),e.jsxs("div",{children:[k," Uploading..."]})]}):e.jsx("div",{children:L(N,30)})})]})}),e.jsx("input",{id:l,className:"hidden",type:"file",onChange:S,ref:d}),i&&e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text-alt",children:i})}),c&&e.jsx("div",{className:"label",children:e.jsx("a",{className:"label-text-alt link",href:c,target:"_blank",children:"دانلود فایل"})}),e.jsx(_,{error:n})]})}export{z as F};
