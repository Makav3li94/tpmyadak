import{u as O,j as e,H as q,L as b,r as E}from"./app-D0BZgUMB.js";import{b as l}from"./sonner-BFuyfz86.js";import{G as A}from"./guest-layout-sS39zqjF.js";import{a as d,s as g}from"./textarea-input-BMCHLsN1.js";import{B as f}from"./button-BtZhFir6.js";import"./lodash-BLbb6PWm.js";/* empty css            */import"./index-DDQ21QUK.js";import"./LandingIntro-DPWitv3G.js";import"./TemplatePointers-CpeWPFuK.js";import"./createLucideIcon-Bo3pdkBr.js";import"./search-CWFc_Glu.js";import"./dayjs-B2iisHW2.js";function ne({status:z}){const{data:s,setData:j,post:I,processing:v,errors:J,reset:D}=O({mobile:"09",name:"",email:"",code:"",password:""}),[p,M]=l.useState(!1),[T,F]=l.useState(null),[B,w]=l.useState(!1),[x,L]=l.useState(!1),[y,c]=l.useState(null),[H,N]=l.useState(null),[P,S]=l.useState(null),[R,u]=l.useState(null),[Q,o]=l.useState(!1),[U,_]=l.useState(""),[n,C]=l.useState(30);l.useEffect(()=>{let t,i;if(n>0)t=setInterval(()=>C(r=>r-1),1e3);else if(n===0)return;return()=>{clearTimeout(i),clearInterval(t)}},[n]),l.useEffect(()=>()=>{D("password")},[]),l.useEffect(()=>{s.code!==null&&s.code.length===4&&k()},[s.code]);const k=t=>{if(s.code===null)return!1;if(u(""),parseInt(T)!==parseInt(G(s.code)))u("کد وارد شده اشتباه است."),o(!0);else return u(null),o(!1),!0},G=t=>t.replace(/[٠-٩۰-۹]/g,i=>i.charCodeAt(0)&15),m=t=>{j(t.target.name,t.target.type==="checkbox"?t.target.checked:t.target.value)},K=t=>{t.code==="Enter"&&I(route("login"))},h=(t,i="login")=>{if(t.preventDefault(),o(!0),c(null),i==="login"||i==="resend")if(C(45),!x||i==="resend")c(null),axios.get(route("phoneStat",{mobile:s.mobile})).then(r=>{if(j("password",""),r.data.user==="True")g("رمز عبور جدید برای شما ارسال شد.","success"),_(r.data.statusMessage),L(!0),o(!1);else if(r.data.user==="False"){if(r.data.sms_active==="yes"){g("کد با موفقیت ارسال شد.","success");let a=(parseInt(r.data.code)-parseInt(s.mobile)*100/2)/1363;console.log(a),F(a)}else M(!0);w(!0),w(!0),o(!1)}if(Object.keys(r.data.errs).length!==0){let a=r.data.errs;a.mobile&&c(a.mobile),o(!1)}}).catch(r=>{console.log(r),o(!1)});else{if(s.password.length!==6){g("لطفا رمز را به درستی وارد کنید.","error");return}E.post(route("login"),{email:s.email,mobile:s.mobile,password:s.password,norm:!0},{onStart:()=>o(!0),onFinish:()=>o(!1),onError:()=>c("شماره همراه یا رمز عبور اشتباه می باشد.")})}else{if(!p&&!k())return!1;c(null),N(null),S(null),axios.post(route("registerPost",{code:s.code,name:s.name,mobile:s.mobile,email:s.email,password:s.password})).then(r=>{if(r.data.status==="success"&&E.visit(route("user.dashboard")),Object.keys(r.data.errs).length!==0){let a=r.data.errs;a.mobile&&c(a.mobile),a.name&&N(a.name),a.email&&S(a.email),a.code&&u(a.code),o(!1)}}).catch(r=>{console.log(r),o(!1)})}};return e.jsxs(A,{children:[e.jsx(q,{title:"ورود | ثبت نام"}),e.jsx("h2",{className:"text-2xl font-semibold mb-2 text-center",children:"ورود | ثبت نام"}),B?e.jsxs("form",{onSubmit:t=>h(t,"register"),children:[e.jsx("div",{className:"mb-4",children:e.jsx(d,{type:"text",label:"نام و نام خانوادگی",name:"name",value:s.name,className:"mt-1 block w-full",onChange:m,error:H})}),e.jsx("div",{className:"mb-4",children:e.jsx(d,{type:"text",label:"ایمیل",name:"email",value:s.email,className:"mt-1 block w-full",onChange:m,error:P})}),!p&&e.jsx("div",{className:"mb-4",children:e.jsx(d,{type:"code",label:"کدتایید",name:"code",value:s.code,className:"mt-1 block w-full",onChange:m,error:R})}),e.jsx(f,{btnType:"submit",processing:v,type:"primary",className:"btn mt-2 w-full btn-primary",children:"ثبت نام"}),p&&e.jsxs(f,{type:"error",onClick:t=>h(t,"resend"),disabled:n!==0,children:["ارسال مجدد",e.jsx("strong",{className:"text-danger mr-2",children:n!==0?n:""})]}),e.jsxs("div",{className:"text-center mt-4",children:["اکانت ندارید ؟",e.jsx(b,{href:route("register"),children:e.jsx("span",{className:"  inline-block  hover:text-primary hover:underline hover:cursor-pointer transition duration-200",children:"ثبت نام"})})," کنید."]})]}):e.jsxs("form",{onSubmit:t=>h(t,"login"),children:[x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsx(d,{type:"password",label:"رمزعبور",name:"password",dir:"ltr",placeholder:"password",value:s.password,className:"mt-1 block w-full",onChange:m,error:y,onKeyDownCapture:K})}),e.jsx("div",{className:"text-right text-primary",children:e.jsx(b,{href:route("password.request"),children:e.jsx("span",{className:"text-sm  inline-block  hover:text-primary hover:underline hover:cursor-pointer transition duration-200",children:"فراموشی رمز عبور"})})})]}):e.jsx("div",{className:"mb-4",children:e.jsx(d,{type:"text",label:"موبایل",name:"mobile",placeholder:"+۹۸",pattern:"\\d{11}",value:s.mobile,className:"mt-1 block w-full",dir:"ltr",maxLength:11,autoFocus:!0,onChange:m,error:y})}),x&&e.jsxs(f,{type:"error",onClick:t=>h(t,"login"),disabled:n!==0,children:["ارسال مجدد",e.jsx("strong",{className:"text-danger mr-2",children:n!==0?n:""})]}),e.jsx(f,{btnType:"submit",processing:v,type:"primary",className:"btn mt-2 w-full btn-primary",children:"ورود"}),e.jsxs("div",{className:"text-center mt-4",children:["اکانت ندارید ؟",e.jsx(b,{href:route("register"),children:e.jsx("span",{className:"  inline-block  hover:text-primary hover:underline hover:cursor-pointer transition duration-200",children:"ثبت نام"})})," کنید."]})]}),e.jsx("p",{className:"text-accent-content/70 text-center  text-xs mt-5",children:"با ورود به سایت قوانین و مقررات را میپذیرم."})]})}export{ne as default};
