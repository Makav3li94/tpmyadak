import{b as p,g as R,l as v,j as e,H as O,L as y,d as A}from"./index-DDca1aiV.js";import{A as B}from"./authenticated-layout-CUcCLVXv.js";import{a as i,b as C,D as x}from"./textarea-input-Bmdp0oLw.js";import{B as u}from"./button-XQ7iUB_I.js";import{C as j}from"./card-BhTpkvGO.js";import{M as P}from"./modal-confirm-CDCTryKL.js";import{S as _}from"./select-input-CYLdNonF.js";import{S as N}from"./select-modal-input-BugIFlqg.js";import{H as f}from"./has-permission-CYmtTqKO.js";import{u as w}from"./hooks-C1aZXtTk.js";import z from"./form-modal-DUjRX8MM.js";import{T as S}from"./trash-BbLWN5rg.js";import"./index-DDQ21QUK.js";import"./x-C5pP27M6.js";import"./createLucideIcon-RXBZCcM_.js";import"./user-profile-menu-DgcEU99t.js";import"./car-DkodfHbk.js";import"./theme-switch-CeGAbILo.js";import"./search-myPFLCWv.js";import"./spinner-D5QHHuo0.js";import"./modal-_zPzG4Kk.js";import"./chevron-left-DQg-zfff.js";import"./chevron-right-BbGDDnQ9.js";function ce(D){const{order:s}=D,d=w(),[M,g]=p.useState(!1),[c,E]=p.useState(!1),h=w(),k={user_id:"",user:"",name:"",postal_code:"",order_address:"",mobile:"",phone:"",address_id:"",address:"",payment_method_id:"",payment_method:"",shipping_method_id:"",shipping_method:"",payment_status:"",shipping_status:"",note:"",status:"",subtotal:"",discount:"",other_fee:"",shipping:"",tax:"",total:""},{data:a,setData:o,post:I,errors:n,clearErrors:U}=R(k),q=t=>{t.preventDefault(),v.isEmpty(s)===!1&&I(route("admin.orders.update",s),{onStart:()=>g(!0),onFinish:l=>{g(!1)}})};p.useEffect(()=>{!c&&!v.isEmpty(s)&&o({user_id:s.user_id,user:s.user,name:s.name,postal_code:s.postal_code,mobile:s.mobile,phone:s.phone,address_id:s.address_id,address:s.address,payment_method_id:s.payment_method_id,payment_method:s.payment_method,payment_status:s.payment_status,shipping_method_id:s.shipping_method_id,shipping_method:s.shipping_method,shipping_status:s.shipping_status,note:s.note,status:s.status,subtotal:s.subtotal,discount:s.discount,other_fee:s.other_fee,shipping:s.shipping,tax:s.tax,total:s.total,_method:"put"}),E(!0)},[s]);const r=t=>{o(t.target.name,t.target.type==="checkbox"?t.target.checked?1:0:t.target.value)},b=(t=null)=>{h.setData(t),h.toggle()},T=t=>{d.setData(t),d.toggle()},F=()=>{d.data!==null&&A.delete(route("admin.order.details.destroy",d.data.id))};function m(t,l){return t.reduce((H,L)=>H+L[l],0)}return p.useEffect(()=>{if(c&&s.details){const t=s.details;o({...a,subtotal:m(t,"total_price"),discount:a.discount===0?m(t,"discount"):a.discount,tax:a.tax===0?m(t,"tax"):a.tax,total:a.subtotal+a.other_fee+a.shipping+a.tax-a.discount})}},[c]),e.jsxs(B,{title:"سفارش",breadcumbs:[{name:"داشبورد",href:route("admin.dashboard")},{name:"سفارش",href:route("admin.orders.index")},{name:"ویرایش/ساخت",href:s?route("admin.orders.show",s):route("admin.orders.create")}],children:[e.jsx(O,{title:"سفارش"}),e.jsxs("form",{className:"flex flex-col gap-3",onSubmit:q,children:[e.jsx(j,{children:e.jsxs("div",{class:"flex gap-5 w-full",children:[e.jsx("div",{className:"basis-1/2",children:e.jsxs("div",{className:"flex flex-col gap-2 justify-between",children:[e.jsx(i,{name:"name",value:a.name,onChange:r,label:"نام",error:n.name,required:!0}),e.jsx(i,{name:"postal_code",value:a.postal_code,onChange:r,label:"کدپستی",error:n.postal_code}),e.jsx(i,{name:"mobile",value:a.mobile,onChange:r,label:"موبایل",error:n.mobile}),e.jsx(i,{name:"phone",value:a.phone,onChange:r,label:"تلفن",error:n.phone}),e.jsx(C,{name:"address",value:a.address,label:"آدرس",onChange:r,error:n.address}),e.jsx(C,{name:"note",value:a.note,label:"نوضیحات",onChange:r,error:n.note})]})}),e.jsxs("div",{className:"basis-1/2 ",children:[e.jsx(i,{name:"created_at",value:s.created_at,label:"تاریخ ثبت",disabled:!0}),e.jsx(i,{name:"created_at",value:s.updated_at,label:"آخرین به روز رسانی",disabled:!0}),e.jsxs("div",{className:"flex flex-col gap-2 justify-between",children:[e.jsxs(_,{label:"وضعیت سفارش",value:a.status,onChange:r,error:n.status,name:"status",required:!0,children:[e.jsx("option",{children:"انتخاب کنید"},"status"),e.jsx("option",{value:"new",children:"جدید"},"status"),e.jsx("option",{value:"pending",children:"در حال بررسی"},"status"),e.jsx("option",{value:"hold",children:"در انتظار"},"status"),e.jsx("option",{value:"verify",children:"تایید شده"},"status"),e.jsx("option",{value:"processing",children:"در حال انجام"},"status"),e.jsx("option",{value:"done",children:"پایان یافته"},"status"),e.jsx("option",{value:"canceled",children:"لغو شده"},"status"),e.jsx("option",{value:"refunded",children:"مرجوعی"},"status")]}),e.jsxs(_,{label:"وضعیت پرداخت",value:a.payment_status,onChange:r,error:n.payment_status,name:"payment_status",required:!0,children:[e.jsx("option",{children:"انتخاب کنید"},"payment_status"),e.jsx("option",{value:"partial",children:"قسطی"},"payment_status"),e.jsx("option",{value:"paid",children:"پرداخت شده"},"payment_status"),e.jsx("option",{value:"refund",children:"مرجوعی"},"payment_status"),e.jsx("option",{value:"unpaid",children:"پرداخت نشده"},"payment_status")]}),e.jsx(N,{label:"متد پرداخت",value:a.payment_method,onChange:t=>o({...a,payment_method:t,payment_method_id:t?t.id:null}),onRemove:()=>o({...a,payment_method:"",payment_method_id:null}),error:n.payment_method_id,params:{table:"payment_methods",columns:"id|title",orderby:"created_at.asc"}}),e.jsxs(_,{label:"وضعیت ارسال",value:a.shipping_status,onChange:r,error:n.shipping_status,name:"shipping_status",required:!0,children:[e.jsx("option",{children:"انتخاب کنید"},"shipping_status"),e.jsx("option",{value:"sending",children:"در حال ارسال"},"shipping_status"),e.jsx("option",{value:"done",children:"تحویل شده"},"shipping_status"),e.jsx("option",{value:"refunded",children:"مرجوعی"},"shipping_status"),e.jsx("option",{value:"not_sent",children:"ارسال نشده"},"shipping_status")]}),e.jsx(N,{label:"متد ارسال",value:a.shipping_method,onChange:t=>o({...a,shipping_method:t,shipping_method_id:t?t.id:null}),onRemove:()=>o({...a,shipping_method:"",shipping_method_id:null}),error:n.shipping_method_id,params:{table:"shipping_methods",columns:"id|title",orderby:"created_at.asc"}})]})]})]})}),e.jsx(j,{children:e.jsxs("div",{className:"flex gap-5",children:[e.jsxs("div",{className:"basis-4/6",children:[e.jsx("div",{className:"flex justify-between",children:e.jsx(f,{p:"create-order",children:e.jsx(u,{size:"sm",type:"info",onClick:()=>b(),children:"افزودن محصول به سفارش"})})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ردیف"}),e.jsx("th",{children:"محصول"}),e.jsx("th",{children:" تعداد"}),e.jsx("th",{children:" قیمت"}),e.jsx("th",{children:"مالیات"}),e.jsx("th",{children:"ویژگی"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:s.details&&s.details.map((t,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:++l}),e.jsx("td",{children:t.title}),e.jsx("td",{children:t.unit}),e.jsx("td",{children:parseInt(t.total_price).toLocaleString("en")}),e.jsx("td",{children:t.tax}),e.jsx("td",{children:t.attribute}),e.jsx("td",{className:"text-right",children:e.jsxs(x,{children:[e.jsx(f,{p:"update-order",children:e.jsx(x.Item,{onClick:()=>b(t),children:e.jsxs("div",{className:"flex space-x-1 items-center",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("div",{children:"ویرایش"})]})})}),e.jsx(f,{p:"delete-order",children:e.jsx(x.Item,{onClick:()=>T(t),children:e.jsxs("div",{className:"flex space-x-1 items-center",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("div",{children:"حذف از سفارش"})]})})})]})})]},l))})]})})]}),e.jsx("div",{className:"basis-2/6",children:e.jsxs("div",{className:"flex flex-col gap-2 justify-between",children:[e.jsx(i,{name:"name",value:a.subtotal,onChange:r,label:"جمع هزینه",error:n.subtotal,required:!0}),e.jsx(i,{name:"discount",value:a.discount,onChange:r,label:"تخفیف",error:n.discount}),e.jsx(i,{name:"other_fee",value:a.other_fee,onChange:r,label:"سایر هزینه ها",error:n.other_fee}),e.jsx(i,{name:"shipping",value:a.shipping,onChange:r,label:"ارسال",error:n.shipping}),e.jsx(i,{name:"shipping",value:a.tax,onChange:r,label:"مالیات",error:n.tax}),e.jsx(i,{name:"name",value:a.total,onChange:r,label:"مبلغ فاکتور",error:n.total,required:!0})]})})]})}),e.jsxs(j,{children:[e.jsx("div",{className:"divider"}),e.jsx("div",{className:"flex items-center ",children:e.jsxs("div",{className:"flex space-x-2 w-full justify-around",children:[e.jsx(u,{processing:M,btnType:"submit",type:"primary",children:"ذخیره"}),e.jsx(y,{href:route("admin.invoice.show",s),children:e.jsx(u,{type:"info",children:"فاکتور"})}),e.jsx(y,{href:route("admin.orders.index"),children:e.jsx(u,{type:"secondary",children:"انصراف"})})]})})]})]}),h.isOpen&&e.jsx(z,{modalState:h,orderId:s.id}),d.isOpen&&e.jsx(P,{onConfirm:F,modalState:d})]})}export{ce as default};
