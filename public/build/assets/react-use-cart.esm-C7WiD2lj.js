import{b as E}from"./sonner-BFuyfz86.js";function o(){return o=Object.assign||function(r){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])}return r},o.apply(this,arguments)}function F(r,t){var a=E.useState(function(){try{var l=typeof window<"u"&&window.localStorage.getItem(r);return l||t}catch{return t}}),n=a[0],m=a[1],d=function(f){try{var s=f instanceof Function?f(n):f;m(s),window.localStorage.setItem(r,s)}catch(v){console.log(v)}};return[n,d]}var T={items:[],isEmpty:!0,totalItems:0,totalUniqueItems:0,cartTotal:0,metadata:{}},h=E.createContext(T),z=function(t){return t===void 0&&(t=12),[].concat(Array(t)).map(function(){return(~~(Math.random()*36)).toString(36)}).join("")},Z=function(){var t=E.useContext(h);if(!t)throw new Error("Expected to be wrapped in a CartProvider");return t};function B(r,t){switch(t.type){case"SET_ITEMS":return M(r,t.payload);case"ADD_ITEM":{var a=[].concat(r.items,[t.payload]);return M(r,a)}case"UPDATE_ITEM":{var n=r.items.map(function(d){return d.id!==t.id?d:o({},d,t.payload)});return M(r,n)}case"REMOVE_ITEM":{var m=r.items.filter(function(d){return d.id!==t.id});return M(r,m)}case"EMPTY_CART":return T;case"CLEAR_CART_META":return o({},r,{metadata:{}});case"SET_CART_META":return o({},r,{metadata:o({},t.payload)});case"UPDATE_CART_META":return o({},r,{metadata:o({},r.metadata,t.payload)});default:throw new Error("No action specified")}}var M=function(t,a){t===void 0&&(t=T);var n=W(a),m=n===0;return o({},T,t,{items:G(a),totalItems:K(a),totalUniqueItems:n,cartTotal:H(a),isEmpty:m})},G=function(t){return t.map(function(a){return o({},a,{itemTotal:a.price*a.quantity})})},H=function(t){return t.reduce(function(a,n){return a+n.quantity*n.price},0)},K=function(t){return t.reduce(function(a,n){return a+n.quantity},0)},W=function(t){return t.length},k=function(t){var a=t.children,n=t.id,m=t.defaultItems,d=m===void 0?[]:m,l=t.onSetItems,f=t.onItemAdd,s=t.onItemUpdate,v=t.onItemRemove,A=t.onEmptyCart,g=t.storage,P=g===void 0?F:g,U=t.metadata,w=n||z(),_=P(n?"react-use-cart-"+w:"react-use-cart",JSON.stringify(o({id:w},T,{items:d,metadata:U}))),D=_[0],S=_[1],R=E.useReducer(B,JSON.parse(D)),p=R[0],i=R[1];E.useEffect(function(){S(JSON.stringify(p))},[p,S]);var O=function(e){i({type:"SET_ITEMS",payload:e.map(function(u){return o({},u,{quantity:u.quantity||1})})}),l&&l(e)},q=function(e,u){if(u===void 0&&(u=1),!e.id)throw new Error("You must provide an `id` for items");if(!(u<=0)){var I=p.items.find(function(Q){return Q.id===e.id});if(!I&&!e.hasOwnProperty("price"))throw new Error("You must pass a `price` for new items");if(!I){var y=o({},e,{quantity:u});i({type:"ADD_ITEM",payload:y}),f&&f(y);return}var C=o({},e,{quantity:I.quantity+u});i({type:"UPDATE_ITEM",id:e.id,payload:C}),s&&s(C)}},x=function(e,u){!e||!u||(i({type:"UPDATE_ITEM",id:e,payload:u}),s&&s(u))},V=function(e,u){if(u<=0){v&&v(e),i({type:"REMOVE_ITEM",id:e});return}var I=p.items.find(function(C){return C.id===e});if(!I)throw new Error("No such item to update");var y=o({},I,{quantity:u});i({type:"UPDATE_ITEM",id:e,payload:y}),s&&s(y)},N=function(e){e&&(i({type:"REMOVE_ITEM",id:e}),v&&v(e))},b=function(){i({type:"EMPTY_CART"}),A&&A()},Y=function(e){return p.items.find(function(u){return u.id===e})},$=function(e){return p.items.some(function(u){return u.id===e})},j=function(){i({type:"CLEAR_CART_META"})},J=function(e){e&&i({type:"SET_CART_META",payload:e})},L=function(e){e&&i({type:"UPDATE_CART_META",payload:e})};return E.createElement(h.Provider,{value:o({},p,{getItem:Y,inCart:$,setItems:O,addItem:q,updateItem:x,updateItemQuantity:V,removeItem:N,emptyCart:b,clearCartMetadata:j,setCartMetadata:J,updateCartMetadata:L})},a)};export{k as C,Z as u};
