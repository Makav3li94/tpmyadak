import{jsxs as s,Fragment as j,jsx as e}from"react/jsx-runtime";import{useState as c,useEffect as I}from"react";import{useCart as C}from"react-use-cart";import{Link as u}from"@inertiajs/react";import{Plus as L,Minus as S,XIcon as q,CheckIcon as T,ClockIcon as M}from"lucide-react";import{s as P,n as z}from"./textarea-input-CS_jPfHL.js";import{B as p}from"./button-s_fcD1op.js";import"sonner";import{O as B}from"./order-layout-CcDW-Zy2.js";import"dayjs";import"theme-change";import"./logo-C8A0auOY.js";function E(o){const[m,f]=c(!1),{items:i,updateItemQuantity:d,cartTotal:g}=C(),[x,y]=c(0),[h,b]=c(0),[N,w]=c(!1);async function k(){const{data:t}=await axios.post(route("home.cart.refresh"),{items:i});let n=!1;t.forEach(r=>{const l=i.find(a=>a.id===r.id);l&&((parseInt(l.price)!==parseInt(r.price)||parseInt(l.discount||0)!==parseInt(r.discount||0))&&(n=!0,l.price=r.price,l.discount=r.discount),d(r.id,r.quantity))}),w(n),v(t)}function v(t=i){let n=t.reduce((l,a)=>l+(a.discount===null,parseInt(a.price)*a.quantity),0),r=t.reduce((l,a)=>l+(a.discount===null?0:parseInt(a.discount)*a.quantity),0);y(n),b(r)}return I(()=>{k().then(()=>{N&&P("قیمت برخی محصولات تغییر کرده و به‌روز شدند!")}),f(!0)},[]),s(j,{children:[e("h1",{className:"sr-only",children:"سبد خرید"}),s("section",{"aria-labelledby":"summary-heading",className:"bg-gray-50 px-4 pb-10 pt-16 sm:px-6 lg:col-start-1 lg:row-start-1 lg:bg-transparent lg:px-0 lg:pb-16",children:[e("h2",{id:"cart-heading",className:"sr-only",children:"محصولات موجود در سبد"}),e("ul",{role:"list",className:"divide-y divide-gray-200 border-b border-t border-gray-200",children:m&&i.map((t,n)=>s("li",{className:"flex py-6 sm:py-10   bg-base-100 card-sm shadow-sm ",children:[e("div",{className:"flex-shrink-0",children:e("img",{alt:t.title,src:`https://cdn.tpmyadak.com/prothumb/${t.image}`,className:"h-24 w-24 rounded-md object-cover object-center sm:h-48 sm:w-48"})}),s("div",{className:"ml-4 flex flex-1 flex-col justify-between sm:ml-6",children:[s("div",{className:"relative pr-9 sm:grid sm:grid-cols-2 sm:gap-x-6 sm:pr-0",children:[s("div",{children:[e("div",{className:"flex justify-between",children:e("h3",{className:"text-sm",children:e(u,{href:t.sku,className:"font-medium text-gray-700 hover:text-gray-800",children:t.title})})}),s("div",{className:"mt-1 flex text-sm",children:[e("p",{className:"text-gray-500",children:"test1"}),t.size?e("p",{className:"ml-4 border-l border-gray-200 pl-4 text-gray-500",children:t.size}):null]}),s("p",{className:"mt-1 text-sm font-medium text-gray-900",children:[parseInt(t.price).toLocaleString("en")," تومان"]})]}),s("div",{className:"mt-4 sm:mt-0 sm:pr-9",children:[e("div",{className:"absolute left-0 top-20",children:s("ul",{className:"action flex items-center list-unstyled justify-center gap-3 ",children:[e("li",{className:"edit",children:e(p,{type:"success",className:"btn-xs",onClick:()=>d(t.id,t.quantity+1),children:e(L,{className:"fs-6_5  align-middle "})})}),e("li",{className:"edit",children:parseInt(t.quantity).toLocaleString("en")}),e("li",{className:"edit",children:e(p,{type:"warning",className:"btn-xs",onClick:r=>d(t.id,t.quantity-1),children:e(S,{className:"fs-6_5  align-middle "})})})]})}),e("div",{className:"absolute left-0 top-0",children:s("button",{type:"button",onClick:()=>removeItem(t.id),className:"-m-2 inline-flex p-2 text-gray-400 hover:text-gray-500",children:[e("span",{className:"sr-only",children:"حذف"}),e(q,{"aria-hidden":"true",className:"h-5 w-5"})]})})]})]}),s("p",{className:"mt-4 flex space-x-2 text-sm text-gray-700",children:[t.stock?e(T,{"aria-hidden":"true",className:"h-5 w-5 flex-shrink-0 text-green-500"}):e(M,{"aria-hidden":"true",className:"h-5 w-5 flex-shrink-0 text-gray-300"}),e("span",{children:t.stock?"موحود در انبار":"ارسال تا 7 روز"})]})]})]},n))})]}),s("section",{"aria-labelledby":"summary-heading",className:"px-4 pb-36 pt-16 sm:px-6 lg:col-start-2 lg:row-start-1 lg:px-0 lg:pb-16",children:[e("h2",{id:"summary-heading",className:"text-lg font-medium text-gray-900",children:"خلاصه سبد"}),m&&s("dl",{className:"mt-6 space-y-4",children:[s("div",{className:"flex items-center justify-between",children:[e("dt",{className:"text-sm text-gray-600",children:"مجموع"}),e("dd",{className:"text-sm font-medium text-gray-900",children:x.toLocaleString("en")})]}),s("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4",children:[e("dt",{className:"flex items-center text-sm text-gray-600",children:e("span",{children:"تخفیف"})}),e("dd",{className:"text-sm font-medium text-gray-900",children:h.toLocaleString("en")})]}),s("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4",children:[e("dt",{className:"text-base font-medium text-gray-900",children:"قابل پرداخت"}),e("dd",{className:"text-base font-medium text-gray-900",children:z((parseInt(g)-h).toLocaleString("en"))})]})]}),e("div",{className:"mt-6",children:e(u,{href:route("home.checkout"),className:"block text-center w-full rounded-md border border-transparent bg-red-600 px-4 py-3 text-base font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-50",children:"رفتن به صفحه صورتحساب"})})]})]})}E.layout=o=>e(B,{children:o});export{E as default};
