import{jsxs as t,Fragment as j,jsx as e}from"react/jsx-runtime";import{useState as c,useEffect as I}from"react";import{useCart as C}from"react-use-cart";import{Link as u}from"@inertiajs/react";import{Plus as L,Minus as S,XIcon as q,CheckIcon as T,ClockIcon as M}from"lucide-react";import{s as P,n as z}from"./textarea-input-CS_jPfHL.js";import{B as p}from"./button-s_fcD1op.js";import"sonner";import{O as B}from"./order-layout-Csg-4_QI.js";import"dayjs";import"theme-change";import"./logo-C8A0auOY.js";function E(o){const[m,f]=c(!1),{items:i,updateItemQuantity:d,cartTotal:g}=C(),[x,b]=c(0),[h,y]=c(0),[N,w]=c(!1);async function k(){const{data:s}=await axios.post(route("home.cart.refresh"),{items:i});let n=!1;s.forEach(a=>{const l=i.find(r=>r.id===a.id);l&&((parseInt(l.price)!==parseInt(a.price)||parseInt(l.discount||0)!==parseInt(a.discount||0))&&(n=!0,l.price=a.price,l.discount=a.discount),d(a.id,a.quantity))}),w(n),v(s)}function v(s=i){let n=s.reduce((l,r)=>l+(r.discount===null,parseInt(r.price)*r.quantity),0),a=s.reduce((l,r)=>l+(r.discount===null?0:parseInt(r.discount)*r.quantity),0);b(n),y(a)}return I(()=>{k().then(()=>{N&&P("قیمت برخی محصولات تغییر کرده و به‌روز شدند!")}),f(!0)},[]),t(j,{children:[e("h1",{className:"sr-only",children:"سبد خرید"}),t("section",{"aria-labelledby":"summary-heading",className:" px-4 pb-10 pt-16 sm:px-6 lg:col-start-1 lg:row-start-1 lg:bg-transparent lg:px-0 lg:pb-16",children:[e("h2",{id:"cart-heading",className:"sr-only",children:"محصولات موجود در سبد"}),e("ul",{role:"list",className:"divide-y divide-gray-200 border-b border-t border-gray-200",children:m&&i.map((s,n)=>t("li",{className:"flex py-6 sm:py-10   bg-base-100 card-sm shadow-sm ",children:[e("div",{className:"flex-shrink-0",children:e("img",{alt:s.title,src:`http://cdn.tpmyadak.com/prothumb/${s.image}`,className:"h-24 w-24 rounded-md object-cover object-center sm:h-48 sm:w-48"})}),t("div",{className:"mr-4 flex flex-1 flex-col justify-between sm:ml-6",children:[t("div",{className:"relative pr-9 sm:grid sm:grid-cols-2 sm:gap-x-6 sm:pr-0",children:[t("div",{children:[e("div",{className:"flex justify-between",children:e("h3",{className:"text-sm",children:e(u,{href:s.sku,className:"font-medium  hover:text-gray-800",children:s.title})})}),e("div",{className:"mt-1 flex text-sm",children:s.size?e("p",{className:"ml-4 border-l border-gray-200 pl-4 text-gray-500",children:s.size}):null}),t("p",{className:"mt-1 text-sm font-medium ",children:[parseInt(s.price).toLocaleString("en")," تومان"]})]}),t("div",{className:"mt-4 sm:mt-0 sm:pr-9",children:[e("div",{className:"absolute left-0 top-20",children:t("ul",{className:"action flex items-center list-unstyled justify-center gap-3 ",children:[e("li",{className:"edit",children:e(p,{type:"success",className:"btn-xs",onClick:()=>d(s.id,s.quantity+1),children:e(L,{className:"fs-6_5  align-middle "})})}),e("li",{className:"edit",children:parseInt(s.quantity).toLocaleString("en")}),e("li",{className:"edit",children:e(p,{type:"warning",className:"btn-xs",onClick:a=>d(s.id,s.quantity-1),children:e(S,{className:"fs-6_5  align-middle "})})})]})}),e("div",{className:"absolute left-0 top-0",children:t("button",{type:"button",onClick:()=>removeItem(s.id),className:"-m-2 inline-flex p-2 text-gray-400 hover:text-gray-500",children:[e("span",{className:"sr-only",children:"حذف"}),e(q,{"aria-hidden":"true",className:"h-5 w-5"})]})})]})]}),t("p",{className:"mt-4 flex space-x-2 text-sm ",children:[s.stock?e(T,{"aria-hidden":"true",className:"h-5 w-5 flex-shrink-0 text-green-500"}):e(M,{"aria-hidden":"true",className:"h-5 w-5 flex-shrink-0 text-gray-300"}),e("span",{children:s.stock?"موحود در انبار":"ارسال تا 7 روز"})]})]})]},n))})]}),t("section",{"aria-labelledby":"summary-heading",className:"px-4 pb-36 pt-16 sm:px-6 lg:col-start-2 lg:row-start-1 lg:px-0 lg:pb-16",children:[e("h2",{id:"summary-heading",className:"text-lg font-medium ",children:"خلاصه سبد"}),m&&t("dl",{className:"mt-6 space-y-4",children:[t("div",{className:"flex items-center justify-between",children:[e("dt",{className:"text-sm ",children:"مجموع"}),e("dd",{className:"text-sm font-medium ",children:x.toLocaleString("en")})]}),t("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4",children:[e("dt",{className:"flex items-center text-sm ",children:e("span",{children:"تخفیف"})}),e("dd",{className:"text-sm font-medium ",children:h.toLocaleString("en")})]}),t("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4",children:[e("dt",{className:"text-base font-medium ",children:"قابل پرداخت"}),e("dd",{className:"text-base font-medium ",children:z((parseInt(g)-h).toLocaleString("en"))})]})]}),e("div",{className:"mt-6",children:e(u,{href:route("home.checkout"),className:"block text-center w-full rounded-md border border-transparent bg-red-600 px-4 py-3 text-base font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-50",children:"رفتن به صفحه صورتحساب"})})]})]})}E.layout=o=>e(B,{children:o});export{E as default};
